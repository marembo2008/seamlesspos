<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">
  <ui:composition template="/seamless_template.xhtml">
    <ui:define name="body">
      <style type="text/css">
        .ui-datatable .ui-datatable-footer {
          text-align: left;
        }
      </style>
      <p:panel id="purchaseReturnPanel">
        <p:dataTable id="purchaseReturnTable" var="pr"
                     value="#{purchasesReturnController.purchasesReturns}" >
          <f:facet name="header">
            <p:accordionPanel activeIndex="0">
              <p:tab title="Return Goods">
                <h:form>
                  <p:panelGrid columns="2" style="width: 100%">
                    <p:outputLabel value="Batch Item" for="itemToReturn"/>
                    <p:autoComplete id="itemToReturn" value="#{purchasesReturnController.purchasesReturn.batch}"
                                    completeMethod="#{batchController.findBatches}"
                                    var="i" itemLabel="#{i.batchNumber}(#{i.item.name})" itemValue="#{i}"
                                    converter="batchConverter" minQueryLength="1" forceSelection="true" queryDelay="100" dropdown="true">
                      <p:ajax event="itemSelect" partialSubmit="true" process="@this"
                              update="@form"/>
                    </p:autoComplete>
                    <p:separator rendered="#{not empty purchasesReturnController.purchasesReturn.batch}"/>
                    <p:separator rendered="#{not empty purchasesReturnController.purchasesReturn.batch}"/>
                    <h:outputLabel value="Batch Quantity" for="batchQuantity"
                                   rendered="#{not empty purchasesReturnController.purchasesReturn.batch}"/>
                    <h:outputText id="batchQuantity" value="#{purchasesReturnController.purchasesReturn.batch.quantity}"
                                  rendered="#{not empty purchasesReturnController.purchasesReturn.batch}"/>
                    <p:separator/>
                    <p:separator/>
                    <p:outputLabel value="Return Quantity" for="returnQuantity"/>
                    <p:inputText value="#{purchasesReturnController.purchasesReturn.returnQuantity}" id="returnQuantity"
                                 validator="#{purchasesReturnController.validateReturnAmount}"/>
                  </p:panelGrid>
                  <p:separator/>
                  <p:commandButton value="Return" actionListener="#{purchasesReturnController.returnGoods()}"
                                   update=":purchaseReturnTable"/>
                </h:form>
              </p:tab>
            </p:accordionPanel>
          </f:facet>
          <p:column  headerText="Batch Number" >
            <h:outputText value="#{pr.batch.batchNumber}" />
          </p:column>
          <p:column id="batch" headerText="Item Code."  >
            <h:outputText value="#{pr.batch.item.itemCode}" />
          </p:column>
          <p:column id="name" headerText="Name" >
            <h:outputText value="#{pr.batch.item.name}" />
          </p:column>
          <p:column id="uPrice" headerText="Unit Price" >
            <h:outputText value="#{pr.batch.item.costAmount}" />
          </p:column>
          <p:column id="Qty" headerText="Batch Quantity" >
            <h:outputText value="#{pr.batch.quantity}" />
          </p:column>
          <p:column  headerText="Return Quantity" >
            <h:outputText value="#{pr.returnQuantity}" />
          </p:column>
          <f:facet name="footer">
            <h:commandButton value="Print" type="button" style="width: 80px; height: 31px; margin-left: 30px"
                             styleClass="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only">
              <p:printer target=":purchaseReturnPanel" />
            </h:commandButton>
          </f:facet>
        </p:dataTable>
      </p:panel>
    </ui:define>
  </ui:composition>
</html>

